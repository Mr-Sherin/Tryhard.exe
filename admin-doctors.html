<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Doctors | Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/interactive.css">
</head>

<body>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-content">
                <div class="navbar-brand">
                    <img src="images/logo.png" alt="MedFlowX" style="height: 40px; width: auto;">
                    <span>MedFlowX</span>
                </div>
                <div class="flex items-center gap-lg">
                    <div style="text-align: right;">
                        <div id="userName" style="font-weight: 600;">Admin Name</div>
                        <div id="userRole" style="font-size: 0.875rem; color: var(--text-secondary);">Admin</div>
                    </div>
                    <button id="logoutBtn" class="btn btn-secondary btn-sm">Logout</button>
                </div>
            </div>
        </div>
    </nav>

    <div class="dashboard-layout">
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <a href="admin-dashboard.html" class="sidebar-item">
                    <span style="font-size: 1.5rem;">üìä</span>
                    <span>Dashboard</span>
                </a>
                <a href="admin-doctors.html" class="sidebar-item active">
                    <span style="font-size: 1.5rem;">üë®‚Äç‚öïÔ∏è</span>
                    <span>Doctors</span>
                </a>
                <a href="admin-departments.html" class="sidebar-item">
                    <span style="font-size: 1.5rem;">üè¢</span>
                    <span>Departments</span>
                </a>
                <a href="admin-billing.html" class="sidebar-item">
                    <span style="font-size: 1.5rem;">üí∞</span>
                    <span>Billing</span>
                </a>
            </nav>
        </aside>

        <main class="main-content">
            <div class="flex justify-between items-center" style="margin-bottom: 2rem;">
                <div>
                    <h1>Manage Doctors</h1>
                    <p style="color: var(--text-secondary); margin: 0;">View and manage all doctors in the hospital</p>
                </div>
                <button class="btn btn-primary" onclick="ModalManager.show('addDoctorModal')">
                    <span>‚ûï</span> Add Doctor
                </button>
            </div>

            <!-- Search and Filter -->
            <div class="card" style="margin-bottom: 2rem;">
                <div class="grid grid-cols-3">
                    <div>
                        <label class="form-label">Search</label>
                        <input type="text" id="searchInput" class="form-input"
                            placeholder="Search by name, department..." oninput="filterDoctors()">
                    </div>
                    <div>
                        <label class="form-label">Department</label>
                        <select id="departmentFilter" class="form-select" onchange="filterDoctors()">
                            <option value="all">All Departments</option>
                            <option value="Cardiology">Cardiology</option>
                            <option value="Neurology">Neurology</option>
                            <option value="Pediatrics">Pediatrics</option>
                            <option value="Orthopedics">Orthopedics</option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label">Status</label>
                        <select id="statusFilter" class="form-select" onchange="filterDoctors()">
                            <option value="all">All Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Doctors Table -->
            <div class="card">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Department</th>
                                <th>Specialization</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Experience</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="doctorsTable">
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Add/Edit Doctor Modal -->
    <div id="addDoctorModal" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Add New Doctor</h3>
                <button class="modal-close" onclick="ModalManager.hide('addDoctorModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="doctorForm">
                    <div class="form-group">
                        <label class="form-label">Doctor Name *</label>
                        <input type="text" id="doctorName" class="form-input" placeholder="Enter doctor name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Department *</label>
                        <select id="doctorDepartment" class="form-select" required>
                            <option value="">Select department</option>
                            <option value="Cardiology">Cardiology</option>
                            <option value="Neurology">Neurology</option>
                            <option value="Pediatrics">Pediatrics</option>
                            <option value="Orthopedics">Orthopedics</option>
                            <option value="Emergency">Emergency</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Specialization *</label>
                        <input type="text" id="doctorSpecialization" class="form-input"
                            placeholder="Enter specialization" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email *</label>
                        <input type="email" id="doctorEmail" class="form-input" placeholder="doctor@hospital.com"
                            required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone *</label>
                        <input type="tel" id="doctorPhone" class="form-input" placeholder="+91 98765 43210" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Experience</label>
                        <input type="text" id="doctorExperience" class="form-input" placeholder="e.g., 10 years">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="ModalManager.hide('addDoctorModal')">Cancel</button>
                <button class="btn btn-success" onclick="handleSaveDoctor()">Save Doctor</button>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
    <script>
        requireAuth('admin');
        initCommonElements();

        let doctors = [...mockData.doctors];
        let filteredDoctors = [...doctors];

        function renderDoctors() {
            const tbody = document.getElementById('doctorsTable');
            tbody.innerHTML = filteredDoctors.map(doctor => `
        <tr>
          <td>
            <div class="flex items-center gap-md">
              <img src="${doctor.image}" alt="${doctor.name}" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
              <strong>${doctor.name}</strong>
            </div>
          </td>
          <td>${doctor.department}</td>
          <td>${doctor.specialization}</td>
          <td>${doctor.email}</td>
          <td>${doctor.phone}</td>
          <td>${doctor.experience}</td>
          <td><span class="badge ${utils.getStatusBadgeClass(doctor.status)}">${doctor.status}</span></td>
          <td>
            <button class="btn btn-sm btn-secondary" onclick="editDoctor('${doctor.id}')">Edit</button>
            <button class="btn btn-sm btn-danger" onclick="deleteDoctor('${doctor.id}')">Delete</button>
          </td>
        </tr>
      `).join('');
        }

        function filterDoctors() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const deptFilter = document.getElementById('departmentFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;

            filteredDoctors = doctors.filter(doctor => {
                const matchesSearch = doctor.name.toLowerCase().includes(searchTerm) ||
                    doctor.department.toLowerCase().includes(searchTerm) ||
                    doctor.specialization.toLowerCase().includes(searchTerm);
                const matchesDept = deptFilter === 'all' || doctor.department === deptFilter;
                const matchesStatus = statusFilter === 'all' || doctor.status === statusFilter;

                return matchesSearch && matchesDept && matchesStatus;
            });

            renderDoctors();
        }

        function handleSaveDoctor() {
            const newDoctor = {
                id: 'doc' + (doctors.length + 1),
                name: document.getElementById('doctorName').value,
                department: document.getElementById('doctorDepartment').value,
                specialization: document.getElementById('doctorSpecialization').value,
                email: document.getElementById('doctorEmail').value,
                phone: document.getElementById('doctorPhone').value,
                experience: document.getElementById('doctorExperience').value || 'New',
                status: 'active'
            };

            doctors.push(newDoctor);
            filteredDoctors = [...doctors];
            renderDoctors();

            NotificationManager.show(`Dr. ${newDoctor.name} added successfully!`, 'success');
            ModalManager.hide('addDoctorModal');
            document.getElementById('doctorForm').reset();
        }

        function editDoctor(id) {
            const doctor = doctors.find(d => d.id === id);
            if (doctor) {
                document.getElementById('doctorName').value = doctor.name;
                document.getElementById('doctorDepartment').value = doctor.department;
                document.getElementById('doctorSpecialization').value = doctor.specialization;
                document.getElementById('doctorEmail').value = doctor.email;
                document.getElementById('doctorPhone').value = doctor.phone;
                document.getElementById('doctorExperience').value = doctor.experience;
                ModalManager.show('addDoctorModal');
            }
        }

        function deleteDoctor(id) {
            if (confirm('Are you sure you want to delete this doctor?')) {
                doctors = doctors.filter(d => d.id !== id);
                filteredDoctors = [...doctors];
                renderDoctors();
                NotificationManager.show('Doctor deleted successfully', 'info');
            }
        }

        // Initial render
        renderDoctors();
    </script>
</body>

</html>